(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{465:function(e,r,a){Promise.resolve().then(a.bind(a,1258))},1258:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return f}});var t=a(7437),n=a(2265),s=a(6994),l=a(3368),i=a(7567),o=a(1023),c=a(7356),d=a(3006);function u(){let e=(0,s.s0)(),[r,a]=(0,n.useState)(!0),[u,f]=(0,n.useState)(!1),[h,p]=(0,n.useState)(null),[x,m]=(0,n.useState)(""),[v,b]=(0,n.useState)(""),[y,g]=(0,n.useState)(null),[w,j]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{a(!0);try{let{data:{session:r},error:a}=await l.O.auth.getSession();if(a)throw a;if(!(null==r?void 0:r.user)){e("/auth");return}let t=r.user.id,n=r.user.email||"";b(n);let{data:s,error:i}=await l.O.from("profiles").select("id, display_name, avatar_url").eq("id",t).single();if(i&&"PGRST116"!==i.code)throw i;s?(p({id:s.id,display_name:s.display_name,avatar_url:s.avatar_url||null}),m(s.display_name||""),g(s.avatar_url||null)):(p({id:t,display_name:null,avatar_url:null}),m(""),g(null))}catch(e){console.error("Failed to load profile:",e),d.A.error("Failed to load profile")}finally{a(!1)}})()},[e]);let N=(0,n.useMemo)(()=>{let e=x||v;return e&&e.split("@")[0].split(" ").filter(Boolean).slice(0,2).map(e=>{var r;return null===(r=e[0])||void 0===r?void 0:r.toUpperCase()}).join("")||"?"},[x,v]),k=async e=>{try{if(j(!0),!e.target.files||0===e.target.files.length)return;let{data:{session:r}}=await l.O.auth.getSession();if(!(null==r?void 0:r.user)){d.A.error("Not authenticated");return}let a=e.target.files[0],t=a.name.split(".").pop(),n=r.user.id,s="".concat(n,"/").concat(Math.random(),".").concat(t);if(y)try{let e=y.split("/"),r=e.findIndex(e=>"avatars"===e);if(-1!==r&&r<e.length-1){let a=e.slice(r+1).join("/");a&&await l.O.storage.from("avatars").remove([a])}}catch(e){console.warn("Failed to delete old avatar:",e)}let{error:i}=await l.O.storage.from("avatars").upload(s,a,{upsert:!0});if(i)throw i;let{data:o}=l.O.storage.from("avatars").getPublicUrl(s);if(g(o.publicUrl),null==r?void 0:r.user){let{error:e}=await l.O.from("profiles").update({avatar_url:o.publicUrl}).eq("id",r.user.id);if(e)throw e;p(e=>e?{...e,avatar_url:o.publicUrl}:null)}d.A.success("Avatar uploaded successfully")}catch(e){console.error("Failed to upload avatar:",e),d.A.error("Failed to upload avatar")}finally{j(!1)}},O=async()=>{try{if(!y)return;let e=y.split("/"),r=e.findIndex(e=>"avatars"===e);if(-1!==r&&r<e.length-1){let a=e.slice(r+1).join("/");a&&await l.O.storage.from("avatars").remove([a])}let{data:{session:a}}=await l.O.auth.getSession();if(null==a?void 0:a.user){let{error:e}=await l.O.from("profiles").update({avatar_url:null}).eq("id",a.user.id);if(e)throw e;p(e=>e?{...e,avatar_url:null}:null),g(null),d.A.success("Avatar removed")}}catch(e){console.error("Failed to remove avatar:",e),d.A.error("Failed to remove avatar")}},_=async()=>{if(h){f(!0);try{let{data:{session:r},error:a}=await l.O.auth.getSession();if(a)throw a;if(!(null==r?void 0:r.user)){e("/auth");return}let t={id:r.user.id,display_name:x.trim()||null,avatar_url:y},{error:n}=await l.O.from("profiles").upsert(t,{onConflict:"id"});if(n)throw n;p(t),d.A.success("Profile updated")}catch(e){console.error("Failed to update profile:",e),d.A.error("Failed to update profile")}finally{f(!1)}}};return(0,t.jsxs)("div",{className:"min-h-screen bg-[var(--bg)]",children:[(0,t.jsx)("header",{className:"sticky top-0 z-50 border-b border-white/10 bg-[var(--bg-surface)]/80 backdrop-blur-md",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex items-center justify-between h-20",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1.5",children:[(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-heading font-bold text-cyan-300 text-glow-cyan",children:"Profile"}),(0,t.jsx)("p",{className:"text-xs sm:text-sm text-cyan-400/70 font-medium",children:"Manage your account details"})]}),(0,t.jsx)(i.z,{variant:"ghost",size:"sm",onClick:()=>e("/lobby"),className:"border border-white/10 hover:bg-white/5 hover:border-cyan-400/30",children:"Back to Lobby"})]})})}),(0,t.jsx)("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-10 lg:py-12",children:(0,t.jsxs)(c.Zb,{className:"hover:shadow-glow-cyan transition-all duration-300",children:[(0,t.jsx)(c.Ol,{children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"relative group",children:[y?(0,t.jsx)("div",{className:"w-20 h-20 rounded-full overflow-hidden border-2 border-cyan-400/30 ring-2 ring-cyan-400/20",children:(0,t.jsx)("img",{src:y,alt:"Profile",className:"w-full h-full object-cover",onError:e=>{let r=e.target;r.style.display="none";let a=r.parentElement;a&&(a.innerHTML='<div class="w-full h-full flex items-center justify-center bg-cyan-400/15 text-cyan-300 font-bold text-lg">'.concat(N,"</div>"))}})}):(0,t.jsx)("div",{className:"w-20 h-20 rounded-full bg-cyan-400/15 border-2 border-cyan-400/30 flex items-center justify-center text-cyan-300 font-bold text-xl ring-2 ring-cyan-400/20",children:N}),(0,t.jsxs)("div",{className:"absolute inset-0 rounded-full bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:[(0,t.jsxs)("label",{className:"cursor-pointer p-2 bg-cyan-400/20 hover:bg-cyan-400/30 rounded-full border border-cyan-400/50",children:[(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:k,disabled:w||r,className:"hidden"}),(0,t.jsx)("svg",{className:"w-4 h-4 text-cyan-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})]}),y&&(0,t.jsx)("button",{onClick:O,disabled:w||r,className:"p-2 bg-red-500/20 hover:bg-red-500/30 rounded-full border border-red-400/50",children:(0,t.jsx)("svg",{className:"w-4 h-4 text-red-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(c.ll,{children:"Profile Info"}),(0,t.jsx)(c.SZ,{className:"mt-1",children:"Update your display name and profile picture. Email is read-only."})]})]})}),(0,t.jsxs)(c.aY,{className:"pt-6 space-y-5",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-xs uppercase tracking-wider text-cyan-300/80 font-semibold",children:"Display Name"}),(0,t.jsx)(o.I,{value:x,onChange:e=>m(e.target.value),placeholder:"Enter your display name",disabled:r})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-xs uppercase tracking-wider text-cyan-300/80 font-semibold",children:"Email"}),(0,t.jsx)(o.I,{value:v,readOnly:!0,disabled:!0})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-2",children:[(0,t.jsx)(i.z,{variant:"secondary",onClick:()=>e("/lobby"),disabled:u||r,children:"Cancel"}),(0,t.jsx)(i.z,{variant:"success",onClick:_,disabled:u||r,children:u?"Saving...":"Save Changes"})]})]})]})})]})}function f(){return(0,t.jsx)(u,{})}},6994:function(e,r,a){"use strict";a.d(r,{UO:function(){return l},s0:function(){return s}});var t=a(9376),n=a(2265);function s(){let e=(0,t.useRouter)();return(r,a)=>{(null==a?void 0:a.replace)?e.replace(r):e.push(r)}}function l(){let e=(0,t.useParams)();return(0,n.useMemo)(()=>{let r={};return e&&Object.entries(e).forEach(e=>{let[a,t]=e;r[a]=Array.isArray(t)?t[0]:t}),r},[e])}},7567:function(e,r,a){"use strict";a.d(r,{z:function(){return l}});var t=a(7437),n=a(2265),s=a(7629);let l=(0,n.forwardRef)((e,r)=>{let{className:a,variant:n="primary",size:l="md",isLoading:i,children:o,disabled:c,...d}=e;return(0,t.jsxs)("button",{ref:r,className:(0,s.cn)("inline-flex items-center justify-center font-heading font-semibold transition-all duration-300 rounded-lg focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-cyber-bg focus-visible:ring-cyan-400 disabled:opacity-50 disabled:cursor-not-allowed relative overflow-hidden",{primary:"glass border-2 border-cyan-400/60 text-cyan-300 hover:border-cyan-400 hover:text-cyan-200 hover:shadow-glow-cyan active:scale-95",secondary:"glass border-2 border-cyan-500/40 text-white hover:border-cyan-400/60 hover:shadow-neon-cyan active:scale-95",ghost:"text-cyan-400 hover:text-cyan-300 hover:bg-cyan-900/20 border border-transparent hover:border-cyan-400/30 active:scale-95",danger:"glass border-2 border-pink-500/60 text-pink-300 hover:border-pink-400 hover:text-pink-200 hover:shadow-glow-magenta active:scale-95",success:"glass border-2 border-lime-400/60 text-lime-300 hover:border-lime-400 hover:text-lime-200 hover:shadow-glow-lime active:scale-95",warning:"glass border-2 border-purple-400/60 text-purple-300 hover:border-purple-400 hover:text-purple-200 hover:shadow-glow-purple active:scale-95"}[n],{sm:"px-3 py-1.5 text-xs h-8",md:"px-4 py-2 text-sm h-10",lg:"px-6 py-3 text-base h-12"}[l],a),disabled:c||i,...d,children:[(0,t.jsx)("div",{className:"absolute inset-0 opacity-0 hover:opacity-100 transition-opacity duration-300",children:(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-cyan-400/20 to-transparent transform -skew-x-12 animate-scanline"})}),(0,t.jsx)("span",{className:"relative z-10",children:i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 inline",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):o})]})});l.displayName="Button"},7356:function(e,r,a){"use strict";a.d(r,{Zb:function(){return c},aY:function(){return o},SZ:function(){return i},Ol:function(){return s},ll:function(){return l}});var t=a(7437),n=a(7629);function s(e){let{className:r,children:a,...s}=e;return(0,t.jsx)("div",{className:(0,n.cn)("px-6 py-4 border-b border-white/10",r),...s,children:a})}function l(e){let{className:r,children:a,...s}=e;return(0,t.jsx)("h3",{className:(0,n.cn)("text-lg font-heading font-bold text-cyan-300",r),...s,children:a})}function i(e){let{className:r,children:a,...s}=e;return(0,t.jsx)("p",{className:(0,n.cn)("text-sm text-cyan-400/70 mt-1",r),...s,children:a})}function o(e){let{className:r,children:a,...s}=e;return(0,t.jsx)("div",{className:(0,n.cn)("px-6 py-4",r),...s,children:a})}function c(e){let{className:r,header:a,footer:s,children:l,...i}=e;return(0,t.jsxs)("div",{className:(0,n.cn)("glass rounded-xl border border-white/10","hover:border-cyan-400/30 hover:bg-white/5 transition-all duration-200",r),...i,children:[a&&(0,t.jsx)("div",{className:"px-6 py-4 border-b border-white/10",children:a}),(0,t.jsx)("div",{className:(0,n.cn)(a||s?"px-6 py-4":"p-6"),children:l}),s&&(0,t.jsx)("div",{className:"px-6 py-4 border-t border-white/10",children:s})]})}},1023:function(e,r,a){"use strict";a.d(r,{I:function(){return l}});var t=a(7437),n=a(2265),s=a(7629);let l=(0,n.forwardRef)((e,r)=>{let{className:a,label:l,hint:i,error:o,id:c,...d}=e,u=(0,n.useId)(),f=c||u;return(0,t.jsxs)("div",{className:"w-full",children:[l&&(0,t.jsx)("label",{htmlFor:f,className:"block text-xs font-heading font-semibold text-cyan-400/80 mb-2 uppercase tracking-wider",children:l}),(0,t.jsx)("input",{ref:r,id:f,className:(0,s.cn)("w-full h-12 px-4 glass border rounded-lg","text-cyan-100 placeholder:text-cyan-400/50","focus:outline-none focus:ring-2 focus:ring-cyan-400/50 focus:border-cyan-400/60","focus:shadow-neon-cyan transition-all duration-300","disabled:opacity-50 disabled:cursor-not-allowed",o?"border-pink-500/60 focus:ring-pink-400/50 focus:border-pink-400/60":"border-cyan-400/30 hover:border-cyan-400/50",a),...d}),i&&!o&&(0,t.jsx)("p",{className:"mt-1.5 text-sm text-cyan-400/70",children:i}),o&&(0,t.jsx)("p",{className:"mt-1.5 text-sm text-pink-400 text-glow-magenta",children:o})]})});l.displayName="Input"},3006:function(e,r,a){"use strict";a.d(r,{A:function(){return u},ToastContainer:function(){return f}});var t=a(7437),n=a(2265),s=a(7629);function l(e){let{toast:r,onRemove:a}=e,[l,i]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=setTimeout(()=>{i(!0),setTimeout(()=>a(r.id),300)},r.duration||3e3);return()=>clearTimeout(e)},[r.id,r.duration,a]),(0,t.jsx)("div",{className:(0,s.cn)("px-4 py-3 rounded-lg border shadow-lg backdrop-blur-sm","transition-all duration-300 ease-in-out",{success:"bg-[var(--success-bg)] border-[var(--success)] text-[var(--success)]",error:"bg-[var(--danger-bg)] border-[var(--danger)] text-[var(--danger)]",info:"bg-[var(--info-bg)] border-[var(--info)] text-[var(--info)]",warning:"bg-[var(--warning-bg)] border-[var(--warning)] text-[var(--warning)]"}[r.type||"info"],l?"opacity-0 translate-x-full":"opacity-100 translate-x-0"),children:(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)("span",{className:"font-medium",children:r.message})})})}let i=0,o=[],c=[];function d(){c.forEach(e=>e([...o]))}let u={show:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",a=arguments.length>2?arguments[2]:void 0,t="toast-".concat(++i);return o.push({id:t,message:e,type:r,duration:a}),d(),t},success:(e,r)=>u.show(e,"success",r),error:(e,r)=>u.show(e,"error",r),info:(e,r)=>u.show(e,"info",r),warning:(e,r)=>u.show(e,"warning",r)};function f(){let[e,r]=(0,n.useState)([]);(0,n.useEffect)(()=>{let e=e=>r(e);return c.push(e),r([...o]),()=>{let r=c.indexOf(e);r>-1&&c.splice(r,1)}},[]);let a=e=>{let r=o.findIndex(r=>r.id===e);r>-1&&(o.splice(r,1),d())};return 0===e.length?null:(0,t.jsx)("div",{className:"fixed top-4 right-4 z-[var(--z-toast)] flex flex-col gap-2 max-w-sm",children:e.map(e=>(0,t.jsx)(l,{toast:e,onRemove:a},e.id))})}},3368:function(e,r,a){"use strict";a.d(r,{O:function(){return i}});var t=a(4687),n=a(257);let s="https://watbrrrtsruvotjisvkp.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndhdGJycnJ0c3J1dm90amlzdmtwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU4Njc0NDQsImV4cCI6MjA4MTQ0MzQ0NH0.s3n81p9aX5cyWbOuPwoKjqLOW7X2nuJQBtxGz1sV3eQ";if(!s||!l)throw console.error("Missing Supabase environment variables:",{hasNextPublicUrl:!0,hasViteUrl:!!n.env.VITE_SUPABASE_URL,hasNextPublicKey:!0,hasViteKey:!!n.env.VITE_SUPABASE_ANON_KEY}),Error("Missing Supabase environment variables. Please check your .env.local file.");let i=(0,t.AY)(s,l)},7629:function(e,r,a){"use strict";function t(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return r.filter(Boolean).join(" ")}a.d(r,{cn:function(){return t}})}},function(e){e.O(0,[639,971,117,744],function(){return e(e.s=465)}),_N_E=e.O()}]);