(()=>{var e={};e.id=494,e.ids=[494],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7421:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>d,routeModule:()=>h,tree:()=>c}),s(7750),s(5804),s(5866);var a=s(3191),t=s(8716),o=s(7922),n=s.n(o),i=s(5231),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);s.d(r,l);let c=["",{children:["lobby",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,7750)),"/Users/bayartsogtbts/Desktop/Gerege Agent AI/Pp/poker_frontend/app/lobby/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,5804)),"/Users/bayartsogtbts/Desktop/Gerege Agent AI/Pp/poker_frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/bayartsogtbts/Desktop/Gerege Agent AI/Pp/poker_frontend/app/lobby/page.tsx"],m="/lobby/page",x={require:s,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/lobby/page",pathname:"/lobby",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},512:(e,r,s)=>{Promise.resolve().then(s.bind(s,2173))},2173:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>f});var a=s(326),t=s(7577),o=s(9065),n=s(5197),i=s(7119),l=s(6495),c=s(1899),d=s(9646),m=s(897),x=s(97);function h({className:e,variant:r="default",size:s="md",children:t,...o}){return a.jsx("span",{className:(0,x.cn)("inline-flex items-center font-semibold rounded-md backdrop-blur-sm",{default:"glass border border-cyan-400/40 text-cyan-300",primary:"bg-cyan-900/50 border border-cyan-400/60 text-cyan-300 shadow-neon-cyan",success:"bg-lime-900/50 border border-lime-400/60 text-lime-300 shadow-neon-lime",danger:"bg-pink-900/50 border border-pink-400/60 text-pink-300 shadow-neon-magenta",warning:"bg-purple-900/50 border border-purple-400/60 text-purple-300 shadow-neon-purple",info:"bg-cyan-900/50 border border-cyan-400/60 text-cyan-300 shadow-neon-cyan"}[r],{sm:"px-2 py-0.5 text-xs font-heading",md:"px-2.5 py-1 text-sm font-heading"}[s],e),...o,children:t})}function u({className:e,active:r,variant:s,children:t,...o}){return a.jsx("button",{className:(0,x.cn)("px-3 py-1.5 text-xs font-heading font-semibold rounded-md transition-all duration-200","border border-white/10 hover:border-cyan-400/40 hover:bg-white/5",r||"active"===s?"bg-cyan-400/20 border-cyan-400/50 text-cyan-300":"bg-transparent text-cyan-400/70",e),...o,children:t})}var p=s(7087);let g=i.Ry({score_limit:i.Rx().int().min(1).max(60).default(60)}),b=i.Ry({code:i.Z_().length(6,"Room code must be 6 characters").transform(e=>e.toUpperCase())});function y(){let[e,r]=(0,t.useState)(null),[s,i]=(0,t.useState)(null),[y,f]=(0,t.useState)(60),[j,v]=(0,t.useState)(""),[N,w]=(0,t.useState)(null),[k,_]=(0,t.useState)(!1),[C,S]=(0,t.useState)([]),[P,A]=(0,t.useState)(!0),[L,R]=(0,t.useState)(""),[M,E]=(0,t.useState)("all"),z=(0,o.s0)(),O=async e=>{e.preventDefault(),w(null),_(!0);try{let{data:{session:e},error:r}=await n.O.auth.getSession();if(r)throw console.error("Session error:",r),Error("Failed to get session");if(!e||!e.user)throw Error("Not authenticated. Please sign in again.");let s=e.user.id;console.log("Creating room for user:",s);let a=g.parse({score_limit:y}),t=function(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",r="";for(let s=0;s<6;s++)r+=e.charAt(Math.floor(Math.random()*e.length));return r}(),{data:o,error:i}=await n.O.from("rooms").insert({code:t,owner_id:s,status:"lobby",score_limit:a.score_limit}).select().single();if(i)throw console.error("Room creation error:",i),Error(i.message||"Failed to create room");if(!o)throw Error("Failed to create room: No room data returned");let{error:l}=await n.O.from("room_players").insert({room_id:o.id,player_id:s,is_ready:!1});if(l)throw console.error("Room player creation error:",l),Error(l.message||"Failed to add player to room");p.A.success(`Room ${t} created!`),z(`/room/${o.id}`)}catch(r){console.error("Create room error:",r);let e="Failed to create room";r instanceof l.jm?e=r.errors[0].message:r instanceof Error?e=r.message:r&&"object"==typeof r&&"message"in r&&(e=String(r.message)),w(e),p.A.error(e)}finally{_(!1)}},$=async e=>{e.preventDefault(),w(null),_(!0);try{let{data:{session:e},error:r}=await n.O.auth.getSession();if(r||!e||!e.user)throw Error("Not authenticated. Please sign in again.");let s=e.user.id,a=b.parse({code:j}),{data:t,error:o}=await n.O.from("rooms").select("id").eq("code",a.code).single();if(o)throw console.error("Room lookup error:",o),Error(o.message||"Room not found");if(!t)throw Error("Room not found");let{error:i}=await n.O.from("room_players").insert({room_id:t.id,player_id:s,is_ready:!1});if(i&&!("23505"===i.code||i.message?.toLowerCase().includes("duplicate")||i.message?.toLowerCase().includes("unique")))throw console.error("Room player join error:",i),Error(i.message||"Failed to join room");p.A.success(`Joined room ${a.code}!`),z(`/room/${t.id}`)}catch(r){console.error("Join room error:",r);let e="Failed to join room";r instanceof l.jm?e=r.errors[0].message:r instanceof Error?e=r.message:r&&"object"==typeof r&&"message"in r&&(e=String(r.message)),w(e),p.A.error(e)}finally{_(!1)}},G=C.filter(e=>{let r=""===L||e.code.toLowerCase().includes(L.toLowerCase()),s="all"===M||e.status===M;return r&&s}),I=({className:e})=>a.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),q=({className:e})=>a.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),D=async()=>{await n.O.auth.signOut(),z("/auth")},F=async e=>{try{let{data:{session:r},error:s}=await n.O.auth.getSession();if(s||!r||!r.user){p.A.error("Not authenticated. Please sign in again.");return}let a=r.user.id,{error:t}=await n.O.from("room_players").insert({room_id:e,player_id:a,is_ready:!1});if(t&&!("23505"===t.code||t.message?.toLowerCase().includes("duplicate")||t.message?.toLowerCase().includes("unique")))throw console.error("Room player join error:",t),Error(t.message||"Failed to join room");z(`/room/${e}`)}catch(r){console.error("Join room by ID error:",r);let e=r instanceof Error?r.message:"Failed to join room";p.A.error(e)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-[var(--bg)]",children:[a.jsx("header",{className:"sticky top-0 z-50 border-b border-white/10 bg-[var(--bg-surface)]/80 backdrop-blur-md",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-20",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1.5",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-heading font-bold text-cyan-300 text-glow-cyan",children:"Game Lobby"}),(s||e)&&(0,a.jsxs)("p",{className:"text-xs sm:text-sm text-cyan-400/70 font-medium",children:["Welcome, ",a.jsx("span",{className:"text-cyan-300",children:s||e})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx(c.z,{variant:"ghost",size:"sm",onClick:()=>z("/profile"),className:"border border-white/10 hover:bg-white/5 hover:border-cyan-400/30",children:"Profile"}),a.jsx(c.z,{variant:"ghost",size:"sm",onClick:D,className:"border border-white/10 hover:bg-white/5 hover:border-cyan-400/30",children:"Sign Out"})]})]})})}),a.jsx("main",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-10 lg:py-12",children:(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 lg:gap-8",children:[(0,a.jsxs)(m.Zb,{className:"hover:shadow-glow-cyan transition-all duration-300",children:[a.jsx(m.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg glass border border-cyan-400/30 flex items-center justify-center bg-cyan-400/10",children:a.jsx(I,{className:"w-5 h-5 text-cyan-400"})}),(0,a.jsxs)("div",{children:[a.jsx(m.ll,{children:"Create Room"}),a.jsx(m.SZ,{className:"mt-1",children:"Start a new game and invite players"})]})]})}),(0,a.jsxs)(m.aY,{className:"pt-6",children:[N&&a.jsx("div",{className:"mb-5 p-3.5 bg-pink-900/20 border border-pink-500/50 text-pink-300 rounded-lg text-sm",children:N}),(0,a.jsxs)("form",{onSubmit:O,className:"space-y-5",children:[a.jsx(d.I,{label:"Score Limit (1-60)",type:"number",value:y,onChange:e=>f(Number(e.target.value)),min:"1",max:"60",disabled:k}),a.jsx("div",{className:"pt-1",children:(0,a.jsxs)(c.z,{type:"submit",disabled:k,isLoading:k,variant:"primary",size:"lg",className:"w-full",children:[!k&&a.jsx(I,{className:"w-4 h-4 mr-2"}),k?"Creating...":"Create Room"]})})]})]})]}),(0,a.jsxs)(m.Zb,{className:"hover:shadow-glow-cyan transition-all duration-300",children:[a.jsx(m.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg glass border border-cyan-400/30 flex items-center justify-center bg-cyan-400/10",children:a.jsx(q,{className:"w-5 h-5 text-cyan-400"})}),(0,a.jsxs)("div",{children:[a.jsx(m.ll,{children:"Join Room"}),a.jsx(m.SZ,{className:"mt-1",children:"Enter a room code to join existing game"})]})]})}),a.jsx(m.aY,{className:"pt-6",children:(0,a.jsxs)("form",{onSubmit:$,className:"space-y-5",children:[a.jsx(d.I,{label:"Room Code",type:"text",value:j,onChange:e=>v(e.target.value.toUpperCase()),placeholder:"ABC123",maxLength:6,disabled:k,className:"font-mono tracking-wider"}),a.jsx("div",{className:"pt-1",children:(0,a.jsxs)(c.z,{type:"submit",disabled:k,isLoading:k,variant:"primary",size:"lg",className:"w-full",children:[!k&&a.jsx(q,{className:"w-4 h-4 mr-2"}),k?"Joining...":"Join Room"]})})]})})]})]}),(0,a.jsxs)(m.Zb,{children:[a.jsx(m.Ol,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx(m.ll,{children:"Recent Rooms"}),a.jsx(m.SZ,{className:"mt-1.5",children:"Browse and join available game rooms"})]}),G.length>0&&(0,a.jsxs)(h,{variant:"info",size:"sm",children:[G.length," ",1===G.length?"room":"rooms"]})]})}),(0,a.jsxs)(m.aY,{className:"pt-6",children:[(0,a.jsxs)("div",{className:"space-y-5 mb-8",children:[(0,a.jsxs)("div",{className:"relative",children:[a.jsx(({className:e})=>a.jsx("svg",{className:e,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-cyan-400/50 pointer-events-none"}),a.jsx(d.I,{type:"text",value:L,onChange:e=>R(e.target.value),placeholder:"Search by room code...",className:"pl-12"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2.5",children:[a.jsx(u,{active:"all"===M,onClick:()=>E("all"),className:"transition-all duration-200",children:"All"}),a.jsx(u,{active:"lobby"===M,onClick:()=>E("lobby"),className:"transition-all duration-200",children:"Waiting"}),a.jsx(u,{active:"playing"===M,onClick:()=>E("playing"),className:"transition-all duration-200",children:"Playing"})]})]}),P?(0,a.jsxs)("div",{className:"py-16 text-center",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-10 w-10 border-3 border-cyan-400 border-t-transparent mb-5"}),a.jsx("p",{className:"text-sm text-cyan-400/70 font-medium",children:"Loading rooms..."})]}):0===G.length?(0,a.jsxs)("div",{className:"py-16 text-center",children:[a.jsx("div",{className:"w-16 h-16 rounded-full glass border border-cyan-400/20 flex items-center justify-center mx-auto mb-5",children:a.jsx(q,{className:"w-8 h-8 text-cyan-400/30"})}),a.jsx("p",{className:"text-sm text-cyan-400/70 font-medium",children:0===C.length?"No rooms available yet. Create one to get started!":"No rooms match your filters."})]}):a.jsx("div",{className:"space-y-3",children:G.map(e=>{let r="lobby"===e.status;return(0,a.jsxs)("div",{className:(0,x.cn)("flex items-center gap-5 p-5 rounded-xl border border-white/10","hover:bg-white/5 hover:border-cyan-400/30 hover:shadow-neon-cyan/20","transition-all duration-300 group cursor-pointer","backdrop-blur-sm"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 flex-shrink-0",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl border border-cyan-400/30 flex items-center justify-center bg-cyan-400/10 group-hover:bg-cyan-400/20 group-hover:border-cyan-400/50 transition-all duration-300",children:a.jsx(q,{className:"w-6 h-6 text-cyan-400"})}),(0,a.jsxs)("div",{className:"flex flex-col gap-0.5",children:[a.jsx("span",{className:"text-xl font-heading font-bold text-cyan-300 font-mono tracking-wider",children:e.code}),a.jsx("span",{className:"text-xs text-cyan-400/50",children:function(e){let r=new Date,s="string"==typeof e?new Date(e):e,a=Math.floor((r.getTime()-s.getTime())/1e3);if(a<60)return"just now";let t=Math.floor(a/60);if(t<60)return`${t} min ago`;let o=Math.floor(t/60);if(o<24)return`${o} hour${o>1?"s":""} ago`;let n=Math.floor(o/24);if(n<7)return`${n} day${n>1?"s":""} ago`;let i=Math.floor(n/7);if(i<4)return`${i} week${i>1?"s":""} ago`;let l=Math.floor(n/30);return`${l} month${l>1?"s":""} ago`}(e.created_at)})]})]}),(0,a.jsxs)("div",{className:"flex-1 min-w-0 flex items-center gap-4 flex-wrap",children:[a.jsx(h,{variant:"playing"===e.status?"success":"info",size:"sm",className:"font-semibold",children:"lobby"===e.status?"WAITING":"PLAYING"}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-cyan-400/70",children:[a.jsx(q,{className:"w-3.5 h-3.5"}),(0,a.jsxs)("span",{className:"font-medium",children:[e.player_count||0," ",1===e.player_count?"player":"players"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-cyan-400/70",children:[a.jsx("span",{className:"font-medium",children:"Limit:"}),a.jsx("span",{className:"text-cyan-300 font-semibold",children:e.score_limit})]})]}),a.jsx(c.z,{variant:r?"primary":"secondary",size:"sm",onClick:()=>F(e.id),disabled:!r,className:"flex-shrink-0 min-w-[100px]",children:r?"Join":"Playing"})]},e.id)})})]})]})]})})]})}function f(){return a.jsx(y,{})}},897:(e,r,s)=>{"use strict";s.d(r,{Zb:()=>c,aY:()=>l,SZ:()=>i,Ol:()=>o,ll:()=>n});var a=s(326),t=s(97);function o({className:e,children:r,...s}){return a.jsx("div",{className:(0,t.cn)("px-6 py-4 border-b border-white/10",e),...s,children:r})}function n({className:e,children:r,...s}){return a.jsx("h3",{className:(0,t.cn)("text-lg font-heading font-bold text-cyan-300",e),...s,children:r})}function i({className:e,children:r,...s}){return a.jsx("p",{className:(0,t.cn)("text-sm text-cyan-400/70 mt-1",e),...s,children:r})}function l({className:e,children:r,...s}){return a.jsx("div",{className:(0,t.cn)("px-6 py-4",e),...s,children:r})}function c({className:e,header:r,footer:s,children:o,...n}){return(0,a.jsxs)("div",{className:(0,t.cn)("glass rounded-xl border border-white/10","hover:border-cyan-400/30 hover:bg-white/5 transition-all duration-200",e),...n,children:[r&&a.jsx("div",{className:"px-6 py-4 border-b border-white/10",children:r}),a.jsx("div",{className:(0,t.cn)(r||s?"px-6 py-4":"p-6"),children:o}),s&&a.jsx("div",{className:"px-6 py-4 border-t border-white/10",children:s})]})}},7750:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>a});let a=(0,s(8570).createProxy)(String.raw`/Users/bayartsogtbts/Desktop/Gerege Agent AI/Pp/poker_frontend/app/lobby/page.tsx#default`)}};var r=require("../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),a=r.X(0,[644,450,119,121],()=>s(7421));module.exports=a})();